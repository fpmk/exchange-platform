<div class="chart-widget h-full flex flex-col bg-gray-800">
  <!-- Header -->
  <div
    class="chart-header px-4 py-2 border-b border-gray-700 flex items-center justify-between"
  >
    <div class="flex items-center gap-4">
      <!--      <h3 class="text-lg font-semibold">{{ appState.selectedSymbol() }}</h3>-->
      <lib-symbol-selector />

      <!-- Interval Selector -->
      <div class="flex gap-1">
        @for (interval of intervals; track interval) {
          <button
            (click)="store.setCandleInterval(interval)"
            [class.bg-blue-600]="store.interval() === interval"
            [class.bg-gray-700]="store.interval() !== interval"
            class="px-2 py-1 text-xs rounded hover:bg-blue-500 transition cursor-pointer"
          >
            {{ interval }}
          </button>
        }
      </div>
    </div>

    <!-- Stats -->
    @if (store.lastCandle(); as lastCandle) {
      <div class="flex items-center gap-4 text-sm">
        <div>
          <span class="text-gray-400">O:</span>
          <span class="text-white ml-1">{{ lastCandle.open.toFixed(2) }}</span>
        </div>
        <div>
          <span class="text-gray-400">H:</span>
          <span class="text-green-400 ml-1"
          >{{ lastCandle.high.toFixed(2) }}</span
          >
        </div>
        <div>
          <span class="text-gray-400">L:</span>
          <span class="text-red-400 ml-1">{{ lastCandle.low.toFixed(2) }}</span>
        </div>
        <div>
          <span class="text-gray-400">C:</span>
          <span class="text-white ml-1">{{ lastCandle.close.toFixed(2) }}</span>
        </div>
      </div>
    }
  </div>

  <!-- Chart Container -->
  <div class="chart-container flex-1 p-4 overflow-hidden">
    @if (store.error()) {
      <div class="h-full flex items-center justify-center">
        <div class="text-red-400">Error: {{ store.error() }}</div>
      </div>
    } @else if (store.hasData()) {
      <div class="h-full bg-gray-900 flex items-center justify-center relative">
        <lib-chart
          #chart
          [loading]="store.loading()"
          [data]="chartData()"
          [showVolume]="showVolume()"
          [theme]="appState.theme()"
          (chartReady)="onChartReady()"
        />
      </div>
    } @else {
      <div class="h-full flex items-center justify-center">
        <div class="text-gray-500">No data</div>
      </div>
    }
  </div>
</div>
